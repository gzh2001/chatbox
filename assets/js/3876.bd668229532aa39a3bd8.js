/*! For license information please see 3876.bd668229532aa39a3bd8.js.LICENSE.txt */
"use strict";(self.webpackChunkxyz_chatboxapp_ce=self.webpackChunkxyz_chatboxapp_ce||[]).push([[3876],{63876:(e,t,s)=>{s.r(t),s.d(t,{component:()=>L});var o=s(74848),i=s(99460),l=s(69019),r=s(40054),n=s(17826),a=s(48324),c=s(20916),d=s(47765),h=s(63403),p=s(65311),m=(0,s(38728).A)("outline","chevron-left","IconChevronLeft",[["path",{d:"M15 6l-6 6l6 6",key:"svg-0"}]]),x=s(74192),v=s(44067),u=s(52166),f=s(78332),g=s(34164),j=s(34843),y=s(96540),b=s(34195),z=s(24597),w=s(62938),k=s(66922),A=s(37938),C=s(84633);const M=y.memo((function(e){const{colorScheme:t}=(0,A.C)(),s=(0,C.U)("light"),i="dark"===t||"auto"===t&&"dark"===s,l=i?"#7D90A1":"#EDF0F2",r=i?"#45525F":"#899AA9";return(0,o.jsxs)("svg",{width:34,height:33,fill:"none",...e,children:[(0,o.jsxs)("mask",{id:"prefix__a",maskUnits:"userSpaceOnUse",x:-.519,y:-.316,width:35,height:34,fill:"#000",children:[(0,o.jsx)("path",{fill:"#fff",d:"M-.519-.316h35v34h-35z"}),(0,o.jsx)("path",{d:"M26.148 2.684a5.333 5.333 0 015.333 5.333v13.037a5.334 5.334 0 01-5.333 5.334h-16.11l-5.19 4.296v-5.198a5.328 5.328 0 01-2.367-4.432V8.017a5.333 5.333 0 015.333-5.333h18.334z"})]}),(0,o.jsx)("path",{d:"M26.148 2.684a5.333 5.333 0 015.333 5.333v13.037a5.334 5.334 0 01-5.333 5.334h-16.11l-5.19 4.296v-5.198a5.328 5.328 0 01-2.367-4.432V8.017a5.333 5.333 0 015.333-5.333h18.334z",fill:l}),(0,o.jsx)("path",{d:"M26.148 2.684V.609v2.075zm5.333 5.333h2.075-2.075zm-5.333 18.37v2.075-2.074zm-16.11 0v-2.073c-.484 0-.952.168-1.324.476l1.323 1.598zm-5.19 4.297H2.776A2.074 2.074 0 006.17 32.28L4.85 30.684zm0-5.198h2.075c0-.691-.345-1.337-.92-1.722L4.85 25.486zM2.482 8.016H.407h2.074zm5.333-5.332V.609v2.075zm18.334 0v2.074c1.8 0 3.26 1.459 3.26 3.259h4.148A7.407 7.407 0 0026.149.608v2.075zm5.333 5.333h-2.074v13.037h4.149V8.017H31.48zm0 13.037h-2.074c0 1.8-1.459 3.26-3.259 3.26v4.148a7.408 7.408 0 007.408-7.408H31.48zm-5.333 5.334v-2.074h-16.11v4.148h16.11v-2.074zm-16.11 0L8.713 24.79l-5.188 4.296 1.323 1.598L6.17 32.28l5.189-4.296-1.323-1.597zm-5.19 4.296h2.075v-5.198H2.775v5.198h2.074zm0-5.198l1.156-1.722a3.254 3.254 0 01-1.448-2.71H.407c0 2.568 1.31 4.83 3.286 6.155l1.156-1.723zm-2.367-4.432h2.075V8.017H.407v13.037h2.074zm0-13.037h2.075a3.26 3.26 0 013.259-3.26V.61A7.407 7.407 0 00.406 8.016h2.074zm5.333-5.333v2.074h18.334V.609H7.814v2.075z",fill:r,mask:"url(#prefix__a)"}),(0,o.jsx)("circle",{cx:12.407,cy:14.386,r:1.63,fill:r,stroke:r,strokeWidth:.296}),(0,o.jsx)("circle",{cx:21.593,cy:14.386,r:1.63,fill:r,stroke:r,strokeWidth:.296})]})}));var I=s(31300),U=s(93351),S=s(8097),N=s(18871),_=s(36920),W=s(80316),B=s(9470),F=s(65958);const V=({selectedId:e,onSelect:t})=>{const{t:s}=(0,b.Bd)(),i=(0,S.L0)(),p=(0,u.Z)(),{copilots:v}=(0,U.v)(),{copilots:f}=(0,U.x)(),g=(0,y.useMemo)((()=>v.length>=10?v:[...v,...v.length&&f.length?[void 0]:[],...f.filter((e=>!v.map((e=>e.id)).includes(e.id))).slice(0,10-v.length-1)]),[v,f]),j=(0,y.useMemo)((()=>g.length<v.length+f.length),[g.length,v.length,f.length]),z=(0,y.useRef)(null),[w,k]=(0,y.useState)({x:0,y:0});return g.length?(0,o.jsxs)(l.B,{gap:"xs",children:[(0,o.jsxs)(r.s,{align:"center",justify:"space-between",mx:"md",children:[(0,o.jsx)(n.E,{size:"xxs",c:"chatbox-tertiary",children:s("My Copilots").toUpperCase()}),!i&&(0,o.jsxs)(r.s,{align:"center",gap:"sm",children:[(0,o.jsx)(a.M,{variant:"transparent",color:"chatbox-tertiary",onClick:()=>{if(z.current){const e=z.current.clientWidth,t=Math.max(w.x-e,0);z.current.scrollTo({left:t,behavior:"smooth"}),k({x:t,y:0})}},children:(0,o.jsx)(m,{size:16})}),(0,o.jsx)(a.M,{variant:"transparent",color:"chatbox-tertiary",onClick:()=>{if(z.current){const e=z.current.scrollWidth,t=z.current.clientWidth,s=Math.min(w.x+t,e-t);z.current.scrollTo({left:s,behavior:"smooth"}),k({x:s,y:0})}},children:(0,o.jsx)(x.A,{size:16})})]})]}),(0,o.jsx)(c.F,{type:"mobile"===_.A.type?"never":"scroll",scrollbars:"x",offsetScrollbars:"x",viewportRef:z,onScrollPositionChange:k,className:"copilot-picker-scroll-area",children:(0,o.jsxs)(r.s,{wrap:"nowrap",gap:"xs",children:[(0,o.jsx)(d.$,{w:"xs"}),g.map((s=>s?(0,o.jsx)(H,{name:s.name,picUrl:s.picUrl,selected:e===s.id,onClick:()=>{t?.(s)}},s.id):(0,o.jsx)(h.c,{orientation:"vertical",my:"xs",mx:"xxs"},"divider"))),j&&(0,o.jsx)(H,{name:s("View All Copilots"),noAvatar:!0,selected:!1,onClick:()=>p({to:"/copilots"})}),(0,o.jsx)(d.$,{w:"xs"})]})})]}):null},H=({name:e,picUrl:t,selected:s,onClick:i,noAvatar:l=!1})=>{const a=(0,S.L0)();return(0,o.jsxs)(r.s,{align:"center",gap:a?"xxs":"xs",py:"xs",px:a?"xs":"md",bd:s?"none":"1px solid var(--mantine-color-chatbox-border-primary-outline)",bg:s?"var(--mantine-color-chatbox-brand-light)":"transparent",className:(0,g.A)("cursor-pointer shrink-0 shadow-[0px_2px_12px_0px_rgba(0,0,0,0.04)]",a?"rounded-full":"rounded-md"),onClick:i,children:[!l&&(0,o.jsx)(p.e,{src:t,color:"chatbox-brand",size:a?20:24,children:e.slice(0,1)}),(0,o.jsx)(n.E,{fw:"600",c:s?"chatbox-brand":"chatbox-primary",children:e})]})},L=function(){const{t:e}=(0,b.Bd)(),t=(0,S.L0)(),[s]=(0,j.fp)(W.f9),[c,d]=(0,j.fp)(W.Zs),[h,p]=(0,j.fp)(W.b8),{settings:m}=(0,N.t0)(),[x,u]=(0,y.useState)({id:"new",...(0,B.cY)()});(0,y.useEffect)((()=>{u((e=>({...e,settings:{...e.settings,maxContextMessageCount:m.maxContextMessageCount||6,temperature:m.temperature||void 0,topP:m.topP||void 0,...m.defaultChatModel?{provider:m.defaultChatModel.provider,modelId:m.defaultChatModel.model}:s}})))}),[s,m]);const g=(0,y.useMemo)((()=>{if(x.settings?.provider&&x.settings.modelId)return{provider:x.settings.provider,modelId:x.settings.modelId}}),[x]),{copilots:A}=(0,U.v)(),{copilots:C}=(0,U.x)(),_=(0,y.useMemo)((()=>x?.copilotId),[x?.copilotId]),L=(0,y.useMemo)((()=>A.find((e=>e.id===_))||C.find((e=>e.id===_))),[A,C,_]);(0,y.useEffect)((()=>{u((e=>({...e,picUrl:L?.picUrl,name:L?.name||"Untitled",messages:L?[{id:(0,w.A)(),role:"system",contentParts:[{type:"text",text:L.prompt}]}]:(0,B.cY)().messages})))}),[L]);const E=(0,f.k)();(0,y.useEffect)((()=>{const{copilotId:e}=E.location.search;e&&u((t=>({...t,copilotId:e})))}),[E.location.search]);return(0,o.jsx)(I.A,{title:"",children:(0,o.jsxs)("div",{className:"p-0 flex flex-col h-full",children:[(0,o.jsxs)(l.B,{align:"center",justify:"center",gap:"sm",flex:1,children:[(0,o.jsx)(M,{className:"h-8"}),(0,o.jsx)(n.E,{fw:"600",size:t?"sm":"md",children:e("What can I help you with today?")})]}),(0,o.jsxs)(l.B,{gap:"sm",children:[x.copilotId?(0,o.jsxs)(l.B,{mx:"md",gap:"sm",children:[(0,o.jsxs)(r.s,{align:"center",gap:"sm",children:[(0,o.jsx)(H,{name:x.name,picUrl:x.picUrl,selected:!0}),(0,o.jsx)(a.M,{size:32,radius:16,c:"chatbox-tertiary",bg:"#F1F3F5",onClick:()=>u((e=>({...e,copilotId:void 0}))),children:(0,o.jsx)(v.A,{size:24})})]}),(0,o.jsx)(n.E,{c:"chatbox-secondary",className:"line-clamp-5",children:x.messages[0]?.contentParts?.map((e=>"text"===e.type?e.text:"")).join("")||""})]}):(0,o.jsx)(V,{onSelect:e=>u((t=>({...t,copilotId:e?.id})))}),(0,o.jsx)(k.A,{sessionType:"chat",sessionId:"new",model:g,fullWidth:!0,onSelectModel:(e,t)=>u((s=>({...s,settings:{...s.settings||{},provider:e,modelId:t}}))),onClickSessionSettings:async()=>{const e=await i.Ay.show("session-settings",{session:x,disableAutoSave:!0});return e&&u((t=>({...t,...e}))),!0},onSubmit:async({needGenerating:e=!0,input:t="",pictureKeys:s=[],attachments:o=[],links:i=[]})=>{const l=await(0,F.jw)({name:x.name,type:"chat",picUrl:x.picUrl,messages:x.messages,copilotId:x.copilotId,settings:x.settings});await(0,F.FB)(l.id),c.knowledgeBase&&(p({...h,[l.id]:c.knowledgeBase}),d({})),B.yT(l.id);const r=(0,z.oH)("user",t);return s&&s.length>0&&r.contentParts.push(...s.map((e=>({type:"image",storageKey:e})))),await B.rj({currentSessionId:l.id,newUserMsg:r,needGenerating:e,attachments:o,links:i}),!0}})]})]})})}},31300:(e,t,s)=>{s.d(t,{A:()=>x});var o=s(74848),i=s(44675),l=s(14992),r=s(11641),n=s(14073),a=s(34843),c=s(49921),d=s(24648),h=s(8097),p=s(63635),m=s(80316);const x=({children:e,title:t,left:s})=>{const[x,v]=(0,a.fp)(m.f1),u=(0,h.L0)(),f=(0,i.A)(),{needRoomForMacWindowControls:g}=(0,d.A)();return(0,o.jsxs)("div",{className:"flex flex-col h-full",children:[(0,o.jsxs)("div",{className:(0,p.cn)("flex flex-row items-center pt-1",u?"":x?"sm:pl-3 sm:pr-2":"pr-2",x&&!u||!g?"pl-3":"pl-20"),style:{borderBottomWidth:"1px",borderBottomStyle:"solid",borderBottomColor:f.palette.divider},children:[s||(!x||u)&&(0,o.jsx)(l.A,{onClick:()=>v(!x),children:(0,o.jsx)(r.A,{sx:u?{borderColor:f.palette.action.hover,borderStyle:"solid",borderWidth:1}:{},children:(0,o.jsx)(c.A,{size:"20",strokeWidth:1.5})})}),(0,o.jsx)("div",{className:(0,p.cn)("title-bar w-full mx-auto flex flex-row","py-2 h-12"),children:"string"==typeof t?(0,o.jsx)(n.A,{variant:"h6",color:"inherit",component:"div",noWrap:!0,sx:{flex:1,overflow:"hidden",textOverflow:"ellipsis",maxWidth:u?"12rem":"18rem"},className:(0,p.cn)("flex items-center",x?"ml-3":"ml-1"),children:t}):t})]}),(0,o.jsx)("div",{className:"flex-1 overflow-auto",children:e})]})}},93351:(e,t,s)=>{s.d(t,{v:()=>n,x:()=>a});var o=s(23342),i=s(34843),l=s(80316),r=s(97286);function n(){const[e,t]=(0,i.fp)(l.Rf);return{copilots:e,addOrUpdate:e=>{t((t=>{let s=!1;const o=t.map((t=>t.id===e.id?(s=!0,e):t));return s||o.push(e),o}))},remove:e=>{t((t=>t.filter((t=>t.id!==e))))}}}function a(){const e=(0,i.md)(l.an),{data:t,...s}=(0,r.I)({queryKey:["remote-copilots",e],queryFn:()=>o.Gg(e),initialData:[],initialDataUpdatedAt:0,staleTime:36e5});return{copilots:t,...s}}},63403:(e,t,s)=>{s.d(t,{c:()=>x});var o=s(74848),i=(s(96540),s(56324)),l=s(59396),r=s(86344),n=s(46100),a=s(52837),c=s(11507),d=s(2412),h={root:"m_3eebeb36",label:"m_9e365f20"};const p={orientation:"horizontal"},m=(0,l.V)(((e,{color:t,variant:s,size:o})=>({root:{"--divider-color":t?(0,r.r)(t,e):void 0,"--divider-border-style":s,"--divider-size":(0,i.YC)(o,"divider-size")}}))),x=(0,d.P9)(((e,t)=>{const s=(0,n.Y)("Divider",p,e),{classNames:i,className:l,style:r,styles:d,unstyled:x,vars:v,color:u,orientation:f,label:g,labelPosition:j,mod:y,...b}=s,z=(0,a.I)({name:"Divider",classes:h,props:s,className:l,style:r,classNames:i,styles:d,unstyled:x,vars:v,varsResolver:m});return(0,o.jsx)(c.a,{ref:t,mod:[{orientation:f,"with-label":!!g},y],...z("root"),...b,role:"separator",children:g&&(0,o.jsx)(c.a,{component:"span",mod:{position:j},...z("label"),children:g})})}));x.classes=h,x.displayName="@mantine/core/Divider"},44067:(e,t,s)=>{s.d(t,{A:()=>o});var o=(0,s(38728).A)("outline","x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]])}}]);